{"version":3,"file":"search/view.js","mappings":"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","sources":["webpack://indice-pagina/./src/search/view.js"],"sourcesContent":["/**\n * Use this file for JavaScript code that you want to run in the front-end\n * on posts/pages that contain this block.\n *\n * When this file is defined as the value of the `viewScript` property\n * in `block.json` it will be enqueued on the front end of the site.\n *\n * Example:\n *\n * ```js\n * {\n *   \"viewScript\": \"file:./view.js\"\n * }\n * ```\n *\n * If you're not making any changes to this file because your project doesn't need any\n * JavaScript running in the front-end, then you should delete this file and remove\n * the `viewScript` property from `block.json`.\n *\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/#view-script\n */\ndocument.addEventListener( 'DOMContentLoaded', function () {\n\tconst openBtn = document.getElementById( 'openSearchModal' );\n\tconst modal = document.getElementById( 'searchModal' );\n\tconst overlay = document.getElementById( 'searchOverlay' );\n\tconst clearBtn = document.getElementById( 'clearSearch' );\n\tconst closeBtn = document.getElementById( 'closeSearchModal' );\n\n\tconst searchInput = document.getElementById( 'searchInput' );\n\tconst searchBtn = document.getElementById( 'searchButton' );\n\tconst searchResults = document.getElementById( 'searchResults' );\n\tconst pagination = document.getElementById( 'pagination' );\n\n\tlet currentQuery = '';\n\tlet currentPage = 1;\n\n\tsearchInput.addEventListener( 'keydown', function ( event ) {\n\t\tif ( event.key === 'Enter' ) {\n\t\t\tevent.preventDefault();\n\t\t\tsearchBtn.click();\n\t\t}\n\t} );\n\n\tsearchBtn.addEventListener( 'click', function () {\n\t\tcurrentQuery = searchInput.value.trim();\n\t\tcurrentPage = 1;\n\t\tperformSearch( currentQuery, currentPage );\n\t} );\n\n\t// \t/wp-admin/admin-ajax.php → è il file di WordPress che riceve e gestisce le chiamate AJAX.\n\t// action=custom_news_search → dice a WordPress quale funzione eseguire. È una specie di \"nome comando\".\n\t// term=... → è il valore che inserisce l’utente nella barra di ricerca (quello che vuoi cercare nel CPT news).\n\tfunction performSearch( query, page ) {\n\t\tif ( ! query ) {\n\t\t\tsearchResults.innerHTML =\n\t\t\t\t'<p class=\"text-muted\">Inserisci un termine di ricerca.</p>';\n\t\t\tpagination.innerHTML = '';\n\t\t\treturn;\n\t\t} else {\n\t\t\tsearchResults.innerHTML =\n\t\t\t\t'<p class=\"text-muted\">Caricamento...</p>';\n\t\t}\n\n\t\tfetch(\n\t\t\t`/wp-admin/admin-ajax.php?action=custom_news_search&term=${ encodeURIComponent(\n\t\t\t\tquery\n\t\t\t) }&page=${ page }`\n\t\t)\n\t\t\t.then( ( response ) => response.json() )\n\t\t\t.then( ( data ) => {\n\t\t\t\tif ( data.posts.length > 0 ) {\n\t\t\t\t\tconst html = data.posts\n\t\t\t\t\t\t.map(\n\t\t\t\t\t\t\t( post ) =>\n\t\t\t\t\t\t\t\t`<li><a href=\"${ post.link }\"><h4>${ post.title }</h4></a></li>`\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.join( '' );\n\t\t\t\t\tsearchResults.innerHTML = `<ul>${ html }</ul>`;\n\n\t\t\t\t\tupdatePagination( data.current_page, data.max_num_pages );\n\t\t\t\t} else {\n\t\t\t\t\tsearchResults.innerHTML =\n\t\t\t\t\t\t'<p class=\"text-muted\">Nessun risultato trovato.</p>';\n\t\t\t\t\tpagination.innerHTML = '';\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.catch( () => {\n\t\t\t\tsearchResults.innerHTML =\n\t\t\t\t\t'<p class=\"text-danger\">Errore nella ricerca.</p>';\n\t\t\t\tpagination.innerHTML = '';\n\t\t\t} );\n\t}\n\n\tfunction updatePagination( current, total ) {\n\t\tlet html = `\n\t\t<nav aria-label=\"Risultati ricerca\">\n\t\t\t<ul class=\"pagination justify-content-center\">\n\t\t\t\t<li class=\"page-item ${ current <= 1 ? 'disabled' : '' }\">\n\t\t\t\t\t<a class=\"page-link\" href=\"#\" data-page=\"${ current - 1 }\">&laquo;</a>\n\t\t\t\t</li>\n\t\t\t\t<li class=\"page-item disabled\">\n\t\t\t\t\t<span class=\"page-link\">${ current } di ${ total }</span>\n\t\t\t\t</li>\n\t\t\t\t<li class=\"page-item ${ current >= total ? 'disabled' : '' }\">\n\t\t\t\t\t<a class=\"page-link\" href=\"#\" data-page=\"${ current + 1 }\">&raquo;</a>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</nav>\n\t`;\n\n\t\tpagination.innerHTML = html;\n\n\t\tdocument\n\t\t\t.querySelectorAll( '#pagination .page-link' )\n\t\t\t.forEach( ( el ) => {\n\t\t\t\tel.addEventListener( 'click', function ( e ) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tconst page = parseInt( this.getAttribute( 'data-page' ) );\n\t\t\t\t\tif ( ! isNaN( page ) ) {\n\t\t\t\t\t\tcurrentPage = page;\n\t\t\t\t\t\tperformSearch( currentQuery, currentPage );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} );\n\t}\n\n\t// Gestione chiusura svuotamenti input\n\t// e apertura del modal\n\tconst openModal = () => {\n\t\tmodal.classList.remove( 'd-none' );\n\t\toverlay.classList.remove( 'd-none' );\n\t\tsearchInput.focus();\n\t};\n\n\tconst closeModal = () => {\n\t\tmodal.classList.add( 'd-none' );\n\t\toverlay.classList.add( 'd-none' );\n\t\tsearchInput.value = '';\n\t\tclearBtn.classList.add( 'd-none' );\n\n\t\t// Resetta i risultati\n\t\tconst results = document.getElementById( 'searchResults' );\n\t\tconst pagination = document.getElementById( 'pagination' );\n\t\tif ( results )\n\t\t\tresults.innerHTML =\n\t\t\t\t'<p class=\"text-muted\">Inserisci un termine di ricerca</p>';\n\t\tif ( pagination ) pagination.innerHTML = '';\n\t};\n\n\topenBtn.addEventListener( 'click', openModal );\n\toverlay.addEventListener( 'click', closeModal );\n\n\tsearchInput.addEventListener( 'input', function () {\n\t\tclearBtn.classList.toggle( 'd-none', ! this.value.length );\n\t} );\n\n\tclearBtn.addEventListener( 'click', function () {\n\t\tsearchInput.value = '';\n\t\tsearchInput.focus();\n\t\tclearBtn.classList.add( 'd-none' );\n\t} );\n\n\tcloseBtn.addEventListener( 'click', closeModal );\n} );\n"],"names":["document","addEventListener","openBtn","getElementById","modal","overlay","clearBtn","closeBtn","searchInput","searchBtn","searchResults","pagination","currentQuery","currentPage","event","key","preventDefault","click","value","trim","performSearch","query","page","innerHTML","fetch","encodeURIComponent","then","response","json","data","posts","length","html","map","post","link","title","join","updatePagination","current_page","max_num_pages","catch","current","total","querySelectorAll","forEach","el","e","parseInt","getAttribute","isNaN","openModal","classList","remove","focus","closeModal","add","results","toggle"],"sourceRoot":""}